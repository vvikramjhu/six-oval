<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <generator>
    <oval:product_name>The OVAL Repository</oval:product_name>
    <oval:schema_version>5.7</oval:schema_version>
    <oval:timestamp>2010-08-05T03:28:32.987-04:00</oval:timestamp>
  </generator>
  <definitions>
    <definition id="oval:org.mitre.oval:def:8500" version="1" class="vulnerability">
      <metadata>
        <title>MySQL 5.0 and 5.1 SELECT Statement DOS Vulnerability</title>
        <affected family="windows">
          <platform>Microsoft Windows 2000</platform>
          <platform>Microsoft Windows XP</platform>
          <platform>Microsoft Windows Server 2003</platform>
          <platform>Microsoft Windows Vista</platform>
          <platform>Microsoft Windows 7</platform>
          <platform>Microsoft Windows Server 2008</platform>
          <product>MySQL Server 5.0</product>
          <product>MySQL Server 5.1</product>
        </affected>
        <reference source="CVE" ref_id="CVE-2009-4019" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4019"/>
        <description>mysqld in MySQL 5.0.x before 5.0.88 and 5.1.x before 5.1.41 does not (1) properly handle errors during execution of certain SELECT statements with subqueries, and does not (2) preserve certain null_value flags during execution of statements that use the GeomFromWKB function, which allows remote authenticated users to cause a denial of service (daemon crash) via a crafted statement.</description>
        <oval_repository>
          <dates>
            <submitted date="2010-01-22T17:00:00.000-05:00">
              <contributor organization="DTCC">J. Daniel Brown</contributor>
            </submitted>
            <status_change date="2010-01-27T13:49:18.646-05:00">DRAFT</status_change>
            <status_change date="2010-02-15T04:00:11.539-05:00">INTERIM</status_change>
            <status_change date="2010-03-08T04:00:15.716-05:00">ACCEPTED</status_change>
          </dates>
          <status>ACCEPTED</status>
        </oval_repository>
      </metadata>
      <criteria operator="OR">
        <criteria operator="AND">
          <extend_definition comment="MySQL 5.0 is installed" definition_ref="oval:org.mitre.oval:def:8282"/>
          <criterion comment="MySQL Server 5.0 version is less than 5.0.88" test_ref="oval:org.mitre.oval:tst:20192"/>
        </criteria>
        <criteria operator="AND">
          <extend_definition comment="MySQL 5.1 is installed" definition_ref="oval:org.mitre.oval:def:8297"/>
          <criterion comment="MySQL Server 5.1 version is less than 5.1.41" test_ref="oval:org.mitre.oval:tst:20859"/>
        </criteria>
      </criteria>
    </definition>
    <definition id="oval:org.mitre.oval:def:8297" version="1" class="inventory">
      <metadata>
        <title>MySQL 5.1 is installed</title>
        <affected family="windows">
          <platform>Microsoft Windows 2000</platform>
          <platform>Microsoft Windows XP</platform>
          <platform>Microsoft Windows Server 2003</platform>
          <platform>Microsoft Windows Vista</platform>
          <platform>Microsoft Windows 7</platform>
          <platform>Microsoft Windows Server 2008</platform>
          <product>MySQL Server 5.1</product>
        </affected>
        <reference source="CPE" ref_id="cpe:/a:mysql:mysql:5.1"/>
        <description>MySQL Server 5.1 is installed</description>
        <oval_repository>
          <dates>
            <submitted date="2010-01-22T17:00:00.000-05:00">
              <contributor organization="DTCC">J. Daniel Brown</contributor>
            </submitted>
            <status_change date="2010-01-27T13:49:16.548-05:00">DRAFT</status_change>
            <status_change date="2010-02-15T04:00:08.919-05:00">INTERIM</status_change>
            <status_change date="2010-03-08T04:00:14.537-05:00">ACCEPTED</status_change>
          </dates>
          <status>ACCEPTED</status>
        </oval_repository>
      </metadata>
      <criteria>
        <criterion comment="MySQL 5.1 is installed" test_ref="oval:org.mitre.oval:tst:21087"/>
        <criterion comment="mysqld.exe or mysqld-nt.exe exists" test_ref="oval:org.mitre.oval:tst:21031"/>
      </criteria>
    </definition>
    <definition id="oval:org.mitre.oval:def:8282" version="1" class="inventory">
      <metadata>
        <title>MySQL 5.0 is installed</title>
        <affected family="windows">
          <platform>Microsoft Windows 2000</platform>
          <platform>Microsoft Windows XP</platform>
          <platform>Microsoft Windows Server 2003</platform>
          <platform>Microsoft Windows Vista</platform>
          <platform>Microsoft Windows 7</platform>
          <platform>Microsoft Windows Server 2008</platform>
          <product>MySQL Server 5.0</product>
        </affected>
        <reference source="CPE" ref_id="cpe:/a:mysql:mysql:5.0"/>
        <description>MySQL Server 5.0 is installed</description>
        <oval_repository>
          <dates>
            <submitted date="2010-01-22T17:00:00.000-05:00">
              <contributor organization="DTCC">J. Daniel Brown</contributor>
            </submitted>
            <status_change date="2010-01-27T13:49:17.724-05:00">DRAFT</status_change>
            <status_change date="2010-02-15T04:00:08.668-05:00">INTERIM</status_change>
            <status_change date="2010-03-08T04:00:14.262-05:00">ACCEPTED</status_change>
          </dates>
          <status>ACCEPTED</status>
        </oval_repository>
      </metadata>
      <criteria>
        <criterion comment="MySQL 5.0 is installed" test_ref="oval:org.mitre.oval:tst:20481"/>
        <criterion comment="mysqld.exe or mysqld-nt.exe exists" test_ref="oval:org.mitre.oval:tst:21031"/>
      </criteria>
    </definition>
  </definitions>
  <tests>
    <registry_test id="oval:org.mitre.oval:tst:21087" version="1" comment="MySQL 5.1 is installed" check_existence="at_least_one_exists" check="at least one" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <object object_ref="oval:org.mitre.oval:obj:911"/>
      <state state_ref="oval:org.mitre.oval:ste:6216"/>
    </registry_test>
    <file_test id="oval:org.mitre.oval:tst:21031" version="1" comment="mysqld.exe or mysqld-nt.exe exists" check_existence="at_least_one_exists" check="all" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <object object_ref="oval:org.mitre.oval:obj:11786"/>
    </file_test>
    <registry_test id="oval:org.mitre.oval:tst:20481" version="1" comment="MySQL 5.0 is installed" check_existence="at_least_one_exists" check="at least one" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <object object_ref="oval:org.mitre.oval:obj:911"/>
      <state state_ref="oval:org.mitre.oval:ste:6475"/>
    </registry_test>
    <registry_test id="oval:org.mitre.oval:tst:20859" version="1" comment="MySQL Server 5.1 version is less than 5.1.41" check_existence="at_least_one_exists" check="at least one" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <object object_ref="oval:org.mitre.oval:obj:11866"/>
      <state state_ref="oval:org.mitre.oval:ste:6693"/>
    </registry_test>
    <registry_test id="oval:org.mitre.oval:tst:20192" version="1" comment="MySQL Server 5.0 version is less than 5.0.88" check_existence="at_least_one_exists" check="at least one" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <object object_ref="oval:org.mitre.oval:obj:11871"/>
      <state state_ref="oval:org.mitre.oval:ste:6359"/>
    </registry_test>
  </tests>
  <objects>
    <file_object id="oval:org.mitre.oval:obj:11786" version="1" comment="Full path to MySQL executable" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <path var_ref="oval:org.mitre.oval:var:349" var_check="all"/>
      <filename operation="pattern match">^mysqld(|-nt)\.exe$</filename>
    </file_object>
    <registry_object id="oval:org.mitre.oval:obj:11992" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <hive>HKEY_LOCAL_MACHINE</hive>
      <key operation="pattern match">^SOFTWARE\\MySQL AB\\MySQL Server [0-9]\.[0-9]$</key>
      <name>Location</name>
    </registry_object>
    <registry_object id="oval:org.mitre.oval:obj:911" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <hive>HKEY_LOCAL_MACHINE</hive>
      <key operation="pattern match">^Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\.*</key>
      <name>DisplayName</name>
    </registry_object>
    <registry_object id="oval:org.mitre.oval:obj:11866" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <hive>HKEY_LOCAL_MACHINE</hive>
      <key>SOFTWARE\MySQL AB\MySQL Server 5.1</key>
      <name>Version</name>
    </registry_object>
    <registry_object id="oval:org.mitre.oval:obj:11871" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <hive>HKEY_LOCAL_MACHINE</hive>
      <key>SOFTWARE\MySQL AB\MySQL Server 5.0</key>
      <name>Version</name>
    </registry_object>
  </objects>
  <states>
    <registry_state id="oval:org.mitre.oval:ste:6216" version="1" comment="MySQL 5.1 check" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <value>MySQL Server 5.1</value>
    </registry_state>
    <registry_state id="oval:org.mitre.oval:ste:6475" version="1" comment="MySQL 5.0 check" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <value>MySQL Server 5.0</value>
    </registry_state>
    <registry_state id="oval:org.mitre.oval:ste:6693" version="1" comment="MySQL Server 5.1 version is less than 5.1.41" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <value operation="pattern match">^5\.1\.(([0-9]|[1-3][0-9]|40)?(|[a-z\_\-]+))$</value>
    </registry_state>
    <registry_state id="oval:org.mitre.oval:ste:6359" version="1" comment="MySQL Server 5.0 version is less than 5.0.88" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows">
      <value operation="pattern match">5\.0\.([0-9]|[1-7][0-9]|8[0-7])?(|[a-z\_\-]+|\..*)$</value>
    </registry_state>
  </states>
  <variables>
    <local_variable id="oval:org.mitre.oval:var:349" version="1" comment="Path to MySQL bin directory" datatype="string">
      <concat>
        <object_component item_field="value" object_ref="oval:org.mitre.oval:obj:11992"/>
        <literal_component>bin\</literal_component>
      </concat>
    </local_variable>
  </variables>
</oval_definitions>